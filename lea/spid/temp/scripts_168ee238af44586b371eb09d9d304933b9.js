
			//Tableau des messages standard
			tab_reponse = new Object();
tab_reponse['0'] = new Object();
tab_reponse['0']['standard_reply_id'] = "1";
tab_reponse['0']['canned_content'] = "HelloBonjour, Nous fermons ici ce ticket. Cordialement, -- Support technique SpireaBest regards";
tab_reponse['1'] = new Object();
tab_reponse['1']['standard_reply_id'] = "2";
tab_reponse['1']['canned_content'] = "HelloBonjour, Nous avons effectués la miseBest regards";
tab_reponse['2'] = new Object();
tab_reponse['2']['standard_reply_id'] = "3";
tab_reponse['2']['canned_content'] = "HelloBest regards";
tab_reponse['3'] = new Object();
tab_reponse['3']['standard_reply_id'] = "4";
tab_reponse['3']['canned_content'] = "HelloCette demande est en attente de validation.<br /><br /><br />Cordialement,<br />--<br />Support technique<br />SpireaBest regards";
tab_reponse['4'] = new Object();
tab_reponse['4']['standard_reply_id'] = "5";
tab_reponse['4']['canned_content'] = "HelloLe ticket est affecté à<br /><br /><br />Cordialement,<br />--<br />Support technique<br />SpireaBest regards";
tab_reponse['5'] = new Object();
tab_reponse['5']['standard_reply_id'] = "6";
tab_reponse['5']['canned_content'] = "HelloCe ticket a Ã©tÃ© rÃ©solu dans le cadre du suivi.<br /><br /><br />&nbsp;Best regards";
tab_reponse['6'] = new Object();
tab_reponse['6']['standard_reply_id'] = "7";
tab_reponse['6']['canned_content'] = "HelloBonjour,<br /><br />Nous annulons ici ce ticket ; n'hÃ©sitez pas Ã nous contacter pour toute question.<br />&nbsp;Best regards";
tab_reponse['7'] = new Object();
tab_reponse['7']['standard_reply_id'] = "8";
tab_reponse['7']['canned_content'] = "Hello<br />Cette demande est-elle toujours d'actualitÃ© ?<br /><br /><br />&nbsp;Best regards";
tab_reponse[''] = new Object();
tab_reponse['']['standard_reply_id'] = null;
tab_reponse['']['canned_content'] = "Bonjour, /n/n Cordialement,";

			//Tableau des etats fermables
			tab_etat = new Object();
tab_etat['0'] = new Object();
tab_etat['0']['state_id'] = "34";
tab_etat['0']['state_close'] = "1";
tab_etat['1'] = new Object();
tab_etat['1']['state_id'] = "20";
tab_etat['1']['state_close'] = "1";
tab_etat['2'] = new Object();
tab_etat['2']['state_id'] = "21";
tab_etat['2']['state_close'] = "1";
tab_etat['3'] = new Object();
tab_etat['3']['state_id'] = "23";
tab_etat['3']['state_close'] = "1";
tab_etat['4'] = new Object();
tab_etat['4']['state_id'] = "24";
tab_etat['4']['state_close'] = "1";
tab_etat['5'] = new Object();
tab_etat['5']['state_id'] = "25";
tab_etat['5']['state_close'] = "1";
tab_etat['6'] = new Object();
tab_etat['6']['state_id'] = "26";
tab_etat['6']['state_close'] = "1";
tab_etat['7'] = new Object();
tab_etat['7']['state_id'] = "27";
tab_etat['7']['state_close'] = "1";
tab_etat['8'] = new Object();
tab_etat['8']['state_id'] = "28";
tab_etat['8']['state_close'] = "1";
tab_etat['9'] = new Object();
tab_etat['9']['state_id'] = "29";
tab_etat['9']['state_close'] = "1";
tab_etat['10'] = new Object();
tab_etat['10']['state_id'] = "30";
tab_etat['10']['state_close'] = "1";
tab_etat['11'] = new Object();
tab_etat['11']['state_id'] = "31";
tab_etat['11']['state_close'] = "1";
tab_etat['12'] = new Object();
tab_etat['12']['state_id'] = "32";
tab_etat['12']['state_close'] = "1";
tab_etat['13'] = new Object();
tab_etat['13']['state_id'] = "33";
tab_etat['13']['state_close'] = "1";
tab_etat['14'] = new Object();
tab_etat['14']['state_id'] = "42";
tab_etat['14']['state_close'] = "1";
tab_etat['15'] = new Object();
tab_etat['15']['state_id'] = "43";
tab_etat['15']['state_close'] = "1";
tab_etat['16'] = new Object();
tab_etat['16']['state_id'] = "44";
tab_etat['16']['state_close'] = "1";
tab_etat['17'] = new Object();
tab_etat['17']['state_id'] = "47";
tab_etat['17']['state_close'] = "1";
tab_etat['18'] = new Object();
tab_etat['18']['state_id'] = "48";
tab_etat['18']['state_close'] = "1";

			//Tableau des categories
			tab_cat = new Object();
tab_cat['0'] = new Object();
tab_cat['0']['name'] = "Travaux";
tab_cat['0']['cat_id'] = "36";
tab_cat['0']['cat_managementgroup'] = "-20";
tab_cat['0']['cat_assignedto'] = "16";
tab_cat['0']['parent'] = "0";
tab_cat['0']['possible_select'] = "1";
tab_cat['0']['group_user'] = "-20,-1";
tab_cat['1'] = new Object();
tab_cat['1']['name'] = "Relevé";
tab_cat['1']['cat_id'] = "37";
tab_cat['1']['cat_managementgroup'] = "-21";
tab_cat['1']['cat_assignedto'] = "14";
tab_cat['1']['parent'] = "0";
tab_cat['1']['possible_select'] = "1";
tab_cat['1']['group_user'] = "-20,-1";
tab_cat['2'] = new Object();
tab_cat['2']['name'] = "Commercial";
tab_cat['2']['cat_id'] = "38";
tab_cat['2']['cat_managementgroup'] = "-22";
tab_cat['2']['cat_assignedto'] = "7";
tab_cat['2']['parent'] = "0";
tab_cat['2']['possible_select'] = "1";
tab_cat['2']['group_user'] = "-20,-1";
tab_cat['3'] = new Object();
tab_cat['3']['name'] = "Comptabilité";
tab_cat['3']['cat_id'] = "39";
tab_cat['3']['cat_managementgroup'] = "-22";
tab_cat['3']['cat_assignedto'] = "7";
tab_cat['3']['parent'] = "0";
tab_cat['3']['possible_select'] = "1";
tab_cat['3']['group_user'] = "-20,-1";

			
		//Fonction pour les réponses standard
		function message(id){
				var tab_id=id.split("-");
				var  oEditor = FCKeditorAPI.GetInstance("exec[reply_content]");
				
				if(tab_id[0]==0){
					//document.getElementById('exec[reply_content]').innerHTML='';	
					oEditor.SetHTML("");
				}else{
					//document.getElementById('exec[reply_content]').innerHTML=tab_reponse[(tab_id[0]-1)]['canned_content'];
					oEditor.SetHTML(tab_reponse[(tab_id[0]-1)]['canned_content']);
				}
				if(document.getElementById('exec[ticket_closed]') != null){
					document.getElementById('exec[ticket_closed]').value=tab_id[1];
				}
					document.getElementById('exec[transition]').value=tab_id[2];
				if((tab_id[1]==1)&&(document.getElementById('exec[ticket_closed]') != null)){
					document.getElementById('exec[ticket_closed]').removeAttribute("disabled");
				}
			}
			
		function etats(id){
				if(document.getElementById("exec[ticket_closed]") != null){
					var select_OpenClose = document.getElementById("exec[ticket_closed]");
					for(var i in tab_etat){
						if(tab_etat[i]['state_id']==id){
							
							select_OpenClose.removeAttribute("disabled");
							break;
						}else{
							select_OpenClose.value=0;
							select_OpenClose.setAttribute("disabled", "disabled");
						}
					
					}
				}
			}
			
		function categories(id){
				var possible=false;
				var valeur_default=0;
				for(var i in tab_cat){
					if(tab_cat[i]['parent']>999){
						if(tab_cat[i]['cat_id']==id){
							if(tab_cat[i]['possible_select']==1){
								possible=true;
							}else{
								var tab_user=tab_cat[i]['group_user'].split(",");
								for(j=0;j<tab_user.value;j++){
									if(tab_user[j]==tab_cat[i]['cat_managementgroup']){
										possible=true;
									}
								}
							}
							if(possible==false){
								valeur_default=tab_cat[i]['parent'];
							}
						}
					}
					if(tab_cat[i]['parent']==0){
						if(tab_cat[i]['cat_id']==id){
							if(tab_cat[i]['possible_select']==1){
								possible=true;
							}else{
								var tab_user=tab_cat[i]['group_user'].split(",");
								for(j=0;j<tab_user.value;j++){
									if(tab_user[j]==tab_cat[i]['cat_managementgroup']){
										possible=true;
									}
								}
							}
							if(possible==false){
								valeur_default=tab_cat[i]['parent'];
							}
						}
					}
				}
				if(possible==false){
					document.getElementById('exec[cat_id]').value=valeur_default;
				}else{
					document.getElementById('exec[cat_id]').value=id;
				}
			}
			
			//Fonction permettant de savoir si la variable passée en paramètre est un objet
			function is_object(obj){
				 return (typeof(obj)!="object")?false:true;
			}
			
				//Tableau des groupeClients
				groupeClients = new Object();
groupeClients[''] = new Object();
groupeClients['']['6'] = "Florent Giacomoni";
groupeClients['']['10'] = "Francis Giacomoni";
groupeClients['']['15'] = "Stéphane Giacomoni";

				//Tableau des membrerGroupesDuUser
				membrerGroupesDuUser = new Object();
membrerGroupesDuUser['-20'] = new Object();
membrerGroupesDuUser['-20']['19'] = "elisabete.loureiro";
membrerGroupesDuUser['-20']['9'] = "emmanuel.damasio";
membrerGroupesDuUser['-20']['6'] = "florent.giacomoni";
membrerGroupesDuUser['-20']['11'] = "ludovic.vahe";
membrerGroupesDuUser['-20']['16'] = "sylvie.ratel";
membrerGroupesDuUser['-1'] = new Object();
membrerGroupesDuUser['-1']['5'] = "administrateur";
membrerGroupesDuUser['-1']['7'] = "aurelie.nuckecheddy";
membrerGroupesDuUser['-1']['8'] = "dino";
membrerGroupesDuUser['-1']['19'] = "elisabete.loureiro";
membrerGroupesDuUser['-1']['9'] = "emmanuel.damasio";
membrerGroupesDuUser['-1']['6'] = "florent.giacomoni";
membrerGroupesDuUser['-1']['10'] = "francis.giacomoni";
membrerGroupesDuUser['-1']['11'] = "ludovic.vahe";
membrerGroupesDuUser['-1']['17'] = "maxime.delaunay";
membrerGroupesDuUser['-1']['12'] = "murat.ulger";
membrerGroupesDuUser['-1']['18'] = "narith.lim";
membrerGroupesDuUser['-1']['13'] = "patricia.allain";
membrerGroupesDuUser['-1']['14'] = "paula.goncalves";
membrerGroupesDuUser['-1']['15'] = "stephane.giacomoni";
membrerGroupesDuUser['-1']['16'] = "sylvie.ratel";

				//Tableau des tabDefault
				tabDefault = new Object();
tabDefault['assigned_to_id'] = "";
tabDefault[''] = "sylvie.ratel";
tabDefault['group_management_id'] = "-23";
tabDefault['group_management_value'] = "MLT-DIRECTION";
tabDefault['group_management_value_users'] = new Object();
tabDefault['group_management_value_users']['6'] = "florent.giacomoni";
tabDefault['group_management_value_users']['10'] = "francis.giacomoni";
tabDefault['group_management_value_users']['15'] = "stephane.giacomoni";
tabDefault['demandeur'] = new Object();
tabDefault['demandeur']['16'] = "sylvie.ratel";

				//Tableau des groupesDuUser
				groupesDuUser = new Object();
groupesDuUser['-20'] = "MLT-TRAVAUX";
groupesDuUser['-1'] = "MULTIMAT";

				//Valeur par défaut;
				
				function ajouterAssigneA(forms,assigne){
					// mise à jour du champs assigne_a
					if(document.getElementById("exec[cat_id]") != null){
						var cat_info=catInfo(document.getElementById("exec[cat_id]").value);
						var cat_managementgroup=cat_info[0]; // ok
						//var cat_assignedto=cat_info[1]; // ok
						var cat_assignedto=assigne; // ok
						var cat_groupUser=cat_info[2];	// ok
						var groupManagement=false;
						for(var g in tabDefault["group_management_value_users"]){
							if(g==16){
								groupManagement=true;
							}
						}
						var myselect=document.getElementById("exec[ticket_assigned_to]");
						// alert("valeur asisgned_to");
						// alert(myselect);
						// myselect=19;
						myselect.options.length=1;
						if(cat_managementgroup==""){
							cat_managementgroup=tabDefault["group_management_id"];
						}
						for(var i in groupeClients[cat_managementgroup]){
							element=groupeClients[cat_managementgroup][i];
							if(i==cat_assignedto){
								nouvel_element = new Option(element,i,false,true);
							}else{
								nouvel_element = new Option(element,i,false,false);
							}
							try{
								myselect.add(nouvel_element,null);
							}catch(e){
								myselect.add(nouvel_element);
							}
						}
						
						if(groupManagement==false){
							if(cat_groupUser==false){
								document.getElementById("exec[ticket_assigned_to]").setAttribute("disabled", "disabled");
							}
						}
						visibleChamp(cat_managementgroup);
					}
				}
				
				function visibleChamp(visibleTemps){
					document.getElementById("exec[ticket_spend_time]").setAttribute("disabled", "disabled");
					if(visibleTemps!=""){
						for(var i in groupesDuUser){
							if(i==visibleTemps){
								document.getElementById("exec[ticket_spend_time]").removeAttribute("disabled");
							}
						}
					}
				}
				
				function ajouterDemandeur(forms) {
					var idGroupe=document.getElementById("exec[account_id]").value;
					var myselect=document.getElementById("exec[ticket_assigned_by]");
					myselect.options.length=1;
					for(var i in groupeClients[idGroupe]){
						element=groupeClients[idGroupe][i];
						if(UnDemandeur(i)==true){
							nouvel_element = new Option(element,i,false,true);
						}else{
							nouvel_element = new Option(element,i,false,false);
						}
						try{
							myselect.add(nouvel_element,null);
						}catch(e){
							myselect.add(nouvel_element);
						}
					}	
				}
				
				function UnDemandeur(i){
					if(tabDefault["demandeur"][i]){
						return true;
					}else{
						return false;
					}
				}
				
				function catInfo(id){
					var info=new Array();
					for(var i in tab_cat){
						if(tab_cat[i]["cat_id"]==id){
							info[0]=tab_cat[i]["cat_managementgroup"];
							info[1]=tab_cat[i]["cat_assignedto"];
							info[2]=false;
							var tab_group_user=tab_cat[i]["group_user"].split(",");
							for(var j=0;j<tab_group_user.length;j++){
								if(tab_group_user[j]==info[0]){
									info[2]=true;
									break;
								}
							}
						}
					}
					// alert(info);
					return info;
				}